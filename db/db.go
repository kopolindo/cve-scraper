package main

import (
	"fmt"
	"database/sql"
	"os"
	_"github.com/mattn/go-sqlite3"
)

var database = ".local/vuln_db"

func main(){
	//Check file existence
	if _, err := os.Stat(database); err != nil {
		fmt.Println("non esiste")
	} else {
		fmt.Println("esiste")
	}
	//Open db file
	cveDB,err_opening := sql.Open("sqlite3",database)
	if err_opening != nil{
		fmt.Println("ERRORE IN FASE DI APERTURA:")
		panic(err_opening)
	}
	//Create table query
	createTest,err_preparing := cveDB.Prepare("CREATE TABLE IF NOT EXISTS people(id INTEGER PRIMARY KEY, firstname TEXT, lastname TEXT, CONSTRAINT identity UNIQUE (firstname, lastname))")
	if err_preparing != nil{
		fmt.Println("ERRORE IN FASE DI PREPARAZIONE QUERY")
		panic(err_preparing)
	}
   createTest.Exec()
	//Insert query
	query,_ := cveDB.Prepare("INSERT OR IGNORE INTO people (firstname, lastname) VALUES (?, ?)")
	query.Exec("alex","conti")
	//Close db file
	cveDB.Close()
}
