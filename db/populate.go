package db

import (
	"database/sql"

	_ "github.com/mattn/go-sqlite3"
)

func Insert(cveDB *sql.DB, params []string) {
	//Insert query
	//fmt.Println("LEN_SLICE", len(params))
	switch l := len(params); l {
	case 3:
		querySw, _ := cveDB.Prepare("INSERT OR IGNORE INTO sw (id,software,version) VALUES (?, ?, ?)")
		querySw.Exec(params[0], params[1], params[2])
	case 7:
		queryCve, _ := cveDB.Prepare("INSERT OR IGNORE INTO cve (id,cve_description,cwe,cwe_description,refs,cvssv2,cvssv3) VALUES (?, ?, ?, ?, ?, ?, ?)")
		queryCve.Exec(params[0], params[1], params[2], params[3], params[4], params[5], params[6])
	}
}
