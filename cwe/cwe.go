package cwe

import (
	"encoding/csv"
	"io"
	"os"
)

var cweList = "cwe/CWE.csv"

func Load() map[string]string {
	//Initialize map m
	m := make(map[string]string)
	//Open file
	file, err := os.Open(cweList)
	if err != nil {
		panic(err)
	}
	//Create new csv reader
	reader := csv.NewReader(file)
	reader.Comma = ','
	//Read it and store in map m
	for {
		record, err := reader.Read()
		if err == io.EOF {
			break
		} else if err != nil {
			panic(err)
		}
		cweID := record[0]
		cweDescription := record[1]
		m[cweID] = cweDescription
		//fmt.Println(record[0], ",", record[1])
	}
	return m
}
