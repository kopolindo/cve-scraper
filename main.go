package main

import (
	"flag"
	"fmt"
	"os"

	"github.com/alecthomas/template"
	_ "github.com/mattn/go-sqlite3"
)

const banner = `
                                                                            
 ####  #    # ######        ####   ####  #####    ##   #####  ###### #####  
#    # #    # #            #      #    # #    #  #  #  #    # #      #    # 
#      #    # #####  #####  ####  #      #    # #    # #    # #####  #    # 
#      #    # #                 # #      #####  ###### #####  #      #####  
#    #  #  #  #            #    # #    # #   #  #    # #      #      #   #  
 ####    ##   ######        ####   ####  #    # #    # #      ###### #    #   
 
 |Version: {{.Ver}}
 |Commit:  {{.Commit}}
 |Build:   {{.Build}}

`

type Version struct {
	Ver    string
	Build  string
	Commit string
}

var ActualVersion = Version{"0.1", "Developing", "de9bd41fa1450f6a5bbb667567040615c945c0c6"}

//FLAGS
var (
	cve       = flag.String("cve", "", "CVE-ID to look for")
	sw        = flag.String("sw", "", "Software name to look for")
	swVersion = flag.String("swv", "", "Software name AND version software")
	version   = flag.Bool("v", false, "Print version and exit")
)

func printbanner() {
	tmpl := template.New("banner")
	template.Must(tmpl.Parse(banner))
	_ = tmpl.Execute(os.Stderr, ActualVersion)
}

func Init() {
	printbanner()
	if flag.NFlag() == 0 {
		fmt.Println("\nUsage flags:")
		flag.PrintDefaults()
		return
	}
	flag.Parse()
}

func main() {
	Init()
}
