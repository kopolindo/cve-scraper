package main

import (
	"encoding/json"
	"fmt"
	"io/ioutil"

	"./nvd"
)
var testJson = "./.sources/nvd/test.json"
var completeList = "./.sources/nvd/nvdcve-1.0-2017.json"
func main() {
	//Declaration
	var test nvd.Root
	var complete nvd.RootComplete
	
	//Read file and unmarshal (test: singol CVE)
	content, _ := ioutil.ReadFile(testJson)
	unm_err := json.Unmarshal(content,&test)
	if unm_err != nil{
		panic(unm_err)
	}

	//Read file and unmarshal (test: Complete list)
	completeContent, _ := ioutil.ReadFile(completeList)
	unm_err_c := json.Unmarshal(completeContent,&complete)
	if unm_err_c != nil{
		panic(unm_err_c)
	}

	//Testo tramite print :S (complete list)
	fmt.Println(complete.CVEDataFormat)
	fmt.Println("\nID:",complete.CVEItems[3].CVE.CVEDataMeta.ID)
	fmt.Println("-----------------\n----- SCORE -----\n-----------------")
	fmt.Println("CVSSv2 vector:",complete.CVEItems[3].Impact.BaseV2.CVSSv2.VectorString)
	fmt.Println("CVSSv3 vector:",complete.CVEItems[3].Impact.BaseV3.CVSSv3.VectorString)
}
