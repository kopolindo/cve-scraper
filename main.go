package main

import (
	"encoding/json"
	"fmt"
	"io/ioutil"
	"./nvd"
	//"./db"
)
var completeList = "./.sources/nvd/nvdcve-1.0-2002.json"
func main() {
	//Declaration
	var complete nvd.RootComplete

	completeContent, _ := ioutil.ReadFile(completeList)
	unm_err_c := json.Unmarshal(completeContent,&complete)
	if unm_err_c != nil{
		panic(unm_err_c)
	}
	cveArray := complete.CVEItems
	//Testo tramite print :S (complete list)
	for _,cve := range cveArray{
		var ID = cve.CVE.CVEDataMeta.ID
		var CvssV2Vector = cve.Impact.BaseV2.CVSSv2.VectorString
		var CvssV3Vector = cve.Impact.BaseV3.CVSSv3.VectorString
		fmt.Println(ID,"\n",CvssV2Vector,"\n",CvssV3Vector)
	}
}
